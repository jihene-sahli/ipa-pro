(function(){angular.module("app",["builder","builder.components","validator.rules"]).controller("FormController",["$scope","$builder","$validator","$http","$rootScope",function(a,b,c,d,e){return a.form=b.forms.default,a.input=[],a.defaultValue={},a.ajaxResponse=0,a.formId="",a.saveError="",a.formError="",a.modalForm={name:"",description:""},a.getParameterByName=function(a){var b,c;return a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search),null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},a.transformRequest=function(a){var b,c,d;c=[];for(b in a)d=a[b],c.push(encodeURIComponent(b)+"="+encodeURIComponent(d));return console.log(c.join("&")),c.join("&")},a.submit=function(b){var f;return f="../../service/form/new",""!==a.formId&&"number"==typeof a.formId&&(f="../../service/form/"+a.formId+"/save"),c.validate(a,"modalForm").success(function(){return d({method:"PUT",data:{name:a.modalForm.name,description:a.modalForm.description,json:JSON.stringify(a.form)},headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:a.transformRequest,url:f}).success(function(c,d,f,g){if(200===d&&"success"===c.status||(a.saveError="An error occured whiel saving form, you may not connected to server"),200===d&&"success"===c.status)return""===a.formId&&"number"==typeof c.formId&&(a.formId=c.formId),a.saveError="",b&&(e.exit=!0,document.location.href="../../pages/formulaire/liste.xhtml"),$("#saveModal").modal("hide")}).error(function(b,c,d,e){if(a.saveError="An error occured whiel saving form",""===a.formId&&"number"==typeof b.formId)return a.formId=b.formId})})},a.getForm=function(c){var e;if(void 0!==c&&""!==c)return e="../../service/form/"+c+"/json",d({method:"GET",url:e}).success(function(c,d,e,f){if(200===d&&"success"===c.status||(a.formError="An error occured whiel getting the form","doesntExists"===c.json?a.formError+=" , form doesn't exist":a.formError+=" , "+c.json,""===a.formId&&"number"==typeof c.formId&&(a.formId=c.formId),$("#formModal").modal("show")),200===d&&"success"===c.status)return""===a.formId&&"number"==typeof c.formId&&(a.formId=c.formId,a.modalForm.name=c.name,a.modalForm.description=c.description,jQuery.each(c.json,function(a,c){return b.addFormObject("default",c)})),a.formError=""}).error(function(b,c,d,e){return a.formError="An error occured whiel saving form, you may not connected to server",$("#formModal").modal("show")})},a.getForm(a.getParameterByName("formId")),a.getListGroups=function(){return d({method:"GET",url:"../../service/group/json"}).success(function(b,c,d,f){return e.listGroups=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.listGroups=[],a.ajaxResponse=a.ajaxResponse+1})},a.getListUsers=function(){return d({method:"GET",url:"../../service/user/json"}).success(function(b,c,d,f){return e.listUsers=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.listUsers=[],a.ajaxResponse=a.ajaxResponse+1})},a.getEntity=function(){return d({method:"GET",url:"../../service/entity/json"}).success(function(b,c,d,f){return e.entity=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.entity=[],a.ajaxResponse=a.ajaxResponse+1})},a.getList=function(){return d({method:"GET",url:"../../service/list/json"}).success(function(b,c,d,f){return e.list=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.list=[],a.ajaxResponse=a.ajaxResponse+1})},a.getTemplate=function(){return d({method:"GET",url:"../../service/template/json"}).success(function(b,c,d,f){return e.templates=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.templates=[],a.ajaxResponse=a.ajaxResponse+1})},a.getForm=function(){return d({method:"GET",url:"../../service/form/json"}).success(function(b,c,d,f){return e.forms=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.forms=[],a.ajaxResponse=a.ajaxResponse+1})},a.getTache=function(){return d({method:"GET",url:"../../service/tache/json"}).success(function(b,c,d,f){return e.taches=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.taches=[],a.ajaxResponse=a.ajaxResponse+1})},a.getRegistres=function(){return d({method:"GET",url:"../../service/registre/json"}).success(function(b,c,d,f){return e.registres=b,a.ajaxResponse=a.ajaxResponse+1}).error(function(b,c,d,f){return e.registres=[],a.ajaxResponse=a.ajaxResponse+1})},a.getListGroups(),a.getListUsers(),a.getEntity(),a.getList(),a.getTemplate(),a.getForm(),a.getTache(),a.getRegistres()}])}).call(this);